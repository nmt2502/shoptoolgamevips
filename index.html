<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" /> 
    
    <title id="page-title">Tool Dự Đoán AI | Dự đoán tài xỉu thông minh AI 2025</title>
    <meta name="description" content="Đa dạng game Tài Xỉu độ chính xác cao, hỗ trợ nhiều nền tảng. Tài xỉu, Sicbo... Bảo mật tuyệt đối, nạp nhanh chóng, hỗ trợ 24/7">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tooldudoanai.fun">
    <meta property="og:title" content="Tool Dự Đoán AI | Dự đoán tài xỉu thông minh AI 2025">
    <meta property="og:description" content="Đa dạng game Tài Xỉu độ chính xác cao, hỗ trợ nhiều nền tảng. Tài xỉu, Sicbo... Bảo mật tuyệt đối, nạp nhanh chóng, hỗ trợ 24/7">
    <meta property="og:image" content="https://sf-static.upanhlaylink.com/img/image_20251213e25072105ca52b60580fbfc26eb99a17.jpg">

    <meta name="twitter:card" content="summary"> 
    <meta name="twitter:url" content="https://tooldudoanai.fun">
    <meta name="twitter:title" content="Tool Dự Đoán AI | Dự đoán tài xỉu thông minh AI 2025">
    <meta name="twitter:description" content="Đa dạng game Tài Xỉu độ chính xác cao, hỗ trợ nhiều nền tảng...">
    <meta name="twitter:image" content="https://sf-static.upanhlaylink.com/img/image_20251213e25072105ca52b60580fbfc26eb99a17.jpg">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <link rel="stylesheet" href="index.css">
</head>

<body>
    <button id="language-toggle" onclick="toggleLanguage()">
        <i class="fas fa-language mr-1"></i> <span id="current-lang-text">VI</span>
    </button>

    <div id="particles"></div>
    
    <div class="main-container">
        <div class="portal-card">
            <div class="portal-header">
                <div class="brand-icon"><i class="fas fa-shield-alt"></i></div>
                <h1 class="brand-title">SHOP TOOL GAME VIP</h1>
                <p class="brand-subtitle" id="form-subtitle" data-lang-key="subtitle_gateway"></p>
            </div>
            
            <div class="portal-tabs">
                <div class="portal-tab active" id="tab-signin" data-lang-key="tab_signin">ĐĂNG NHẬP</div>
                <div class="portal-tab" id="tab-signup" data-lang-key="tab_signup">ĐĂNG KÝ</div>
            </div>
            
            <div class="portal-forms">
                <div class="form-container active" id="form-signin">
                    <form onsubmit="handleLogin(event)" class="portal-form">
                        <div class="input-field">
                            <label class="input-label" data-lang-key="label_email">Tên Đăng Nhập</label>
                            <div class="input-container">
                                <i class="fas fa-user"></i>
                                <input type="text" id="login_email" data-lang-placeholder="placeholder_email_login" placeholder="Nhập tên đăng nhập" required />
                            </div>
                        </div>
                        
                        <div class="input-field">
                            <label class="input-label" data-lang-key="label_password">Mật Khẩu</label>
                            <div class="input-container">
                                <i class="fas fa-lock"></i>
                                <input type="password" id="login_pass" data-lang-placeholder="placeholder_password" placeholder="Nhập mật khẩu" required />
                                <i class="fas fa-eye password-toggle" onclick="togglePass('login_pass', this)"></i>
                            </div>
                        </div>
                        
                        <div class="form-helper">
                            <label class="remember-check">
                                <input type="checkbox" id="remember_me" />
                                <span data-lang-key="text_remember">Ghi nhớ đăng nhập</span>
                            </label>
                        </div>
                        
                        <button type="submit" class="primary-btn" id="btn-login" data-lang-key="btn_signin">
                            <i class="fas fa-sign-in-alt" style="margin-right:10px"></i> ĐĂNG NHẬP
                        </button>
                    </form>
                </div>
                
                <div class="form-container" id="form-signup">
                    <form onsubmit="handleRegister(event)" class="portal-form">
                        <div class="input-field">
                            <label class="input-label" data-lang-key="label_name">Họ và Tên</label>
                            <div class="input-container">
                                <i class="fas fa-user-circle"></i>
                                <input type="text" id="reg_name" data-lang-placeholder="placeholder_name" placeholder="Nhập họ và tên" required />
                            </div>
                        </div>
                        
                        <div class="input-field">
                            <label class="input-label" data-lang-key="label_email">Tên Đăng Nhập</label>
                            <div class="input-container">
                                <i class="fas fa-user"></i>
                                <input type="text" id="reg_email" data-lang-placeholder="placeholder_email_reg" placeholder="Tạo tên đăng nhập (viết liền)" required />
                            </div>
                        </div>
                        
                        <div class="input-field">
                            <label class="input-label" data-lang-key="label_password">Mật Khẩu</label>
                            <div class="input-container">
                                <i class="fas fa-key"></i>
                                <input type="password" id="reg_pass" data-lang-placeholder="placeholder_password_create" placeholder="Tạo mật khẩu mạnh" required oninput="checkStrength()" />
                                <i class="fas fa-eye password-toggle" onclick="togglePass('reg_pass', this)"></i>
                            </div>
                            <div class="strength-container">
                                <div class="strength-bars">
                                    <div class="strength-bar"></div>
                                    <div class="strength-bar"></div>
                                    <div class="strength-bar"></div>
                                    <div class="strength-bar"></div>
                                    <div class="strength-bar"></div>
                                </div>
                                <div class="strength-text" id="strength-text" data-lang-key="text_strength">Độ mạnh mật khẩu</div>
                            </div>
                        </div>
                        
                        <div class="input-field">
                            <label class="input-label" data-lang-key="label_confirm">Xác Nhận Mật Khẩu</label>
                            <div class="input-container">
                                <i class="fas fa-shield-alt"></i>
                                <input type="password" id="confirm_pass" data-lang-placeholder="placeholder_password_confirm" placeholder="Nhập lại mật khẩu" required />
                                <i class="fas fa-eye password-toggle" onclick="togglePass('confirm_pass', this)"></i>
                            </div>
                        </div>
                        
                        <button type="submit" class="primary-btn" id="btn-register" data-lang-key="btn_signup">
                            <i class="fas fa-user-plus" style="margin-right:10px"></i> TẠO TÀI KHOẢN
                        </button>
                    </form>
                </div>

                <button class="support-btn-link" onclick="showSupportModal()" data-lang-key="btn_support">
                    <i class="fas fa-headset text-lg text-red-400"></i> LIÊN HỆ HỖ TRỢ
                </button>
            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="support-modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeSupportModal()"><i class="fas fa-times"></i></button>
            <h2 class="modal-title text-center text-xl font-bold text-white mb-2" data-lang-key="modal_support_title">HỖ TRỢ 24/7</h2>
            <p class="modal-subtitle text-center text-sm text-gray-400 mb-6" data-lang-key="modal_support_subtitle">Liên hệ với chúng tôi qua</p>
            
            <div class="space-y-4">
                <a href="https://t.me/maicutevip11" target="_blank" class="support-link">
                    <div class="support-icon-box support-telegram-icon"><i class="fab fa-telegram"></i></div>
                    <div class="support-info">
                        <p class="support-label" data-lang-key="label_telegram">Telegram</p>
                        <p class="support-value">@maicutevip11</p>
                    </div>
                    <i class="fas fa-chevron-right text-slate-400 text-sm"></i>
                </a>
            </div>
            
            <button class="support-btn-link mt-6" onclick="closeSupportModal()">
                <i class="fas fa-arrow-left"></i> <span data-lang-key="btn_back">QUAY LẠI</span>
            </button>
        </div>
    </div>

    <script>
        // ==========================================
        // CẤU HÌNH API (ĐỔI LINK NÀY BẰNG LINK CỦA BẠN)
        // ==========================================
        const API_URL = 'https://script.google.com/macros/s/AKfycbywkNHUI6v1EzAoCmKahp7PiTxL5eGQXA0ouEsTya1JeEtNaXntYFAdQ6gVektPdI_3/exec'; 

        // ========== LOGIC GIAO DIỆN ==========
        const translations = {
            'vi': {
                'page-title': 'Cổng Truy Cập | Đăng Nhập An Toàn', 'subtitle_gateway': 'Cổng Xác Thực An Toàn', 'subtitle_create': 'Tạo Tài Khoản Mới',
                'tab_signin': 'ĐĂNG NHẬP', 'tab_signup': 'ĐĂNG KÝ',
                'label_email': 'Tên Đăng Nhập', 'label_password': 'Mật Khẩu', 'label_name': 'Họ và Tên', 'label_confirm': 'Xác Nhận Mật Khẩu',
                'placeholder_email_login': 'Nhập tên đăng nhập', 'placeholder_email_reg': 'Tạo tên đăng nhập', 'placeholder_name': 'Nhập họ tên',
                'placeholder_password': 'Nhập mật khẩu', 'placeholder_password_create': 'Tạo mật khẩu mạnh', 'placeholder_password_confirm': 'Nhập lại mật khẩu',
                'text_remember': 'Ghi nhớ đăng nhập', 'btn_signin': '<i class="fas fa-sign-in-alt"></i> ĐĂNG NHẬP', 'btn_signup': '<i class="fas fa-user-plus"></i> TẠO TÀI KHOẢN',
                'btn_support': '<i class="fas fa-headset text-lg text-red-400"></i> LIÊN HỆ HỖ TRỢ', 'text_strength': 'Độ mạnh mật khẩu'
            },
            'en': {
                'page-title': 'Portal Access | Secure Entry', 'subtitle_gateway': 'Secure Gateway', 'subtitle_create': 'Create Account',
                'tab_signin': 'SIGN IN', 'tab_signup': 'SIGN UP',
                'label_email': 'Username', 'label_password': 'Password', 'label_name': 'Full Name', 'label_confirm': 'Confirm Password',
                'placeholder_email_login': 'Enter username', 'placeholder_email_reg': 'Create username', 'placeholder_name': 'Full name',
                'placeholder_password': 'Enter password', 'placeholder_password_create': 'Create password', 'placeholder_password_confirm': 'Confirm password',
                'text_remember': 'Remember me', 'btn_signin': '<i class="fas fa-sign-in-alt"></i> SIGN IN', 'btn_signup': '<i class="fas fa-user-plus"></i> SIGN UP',
                'btn_support': '<i class="fas fa-headset text-lg text-red-400"></i> SUPPORT', 'text_strength': 'Password Strength'
            }
        };
        let currentLang = 'vi';

        document.addEventListener('DOMContentLoaded', function() {
            createParticles();
            initEventListeners();
            
            // Auto Login Check
            const savedUser = localStorage.getItem('user_credential');
            const isRemember = localStorage.getItem('remember_me');
            if(savedUser && isRemember === 'true') {
                const user = JSON.parse(savedUser);
                if(user) {
                    if (user.account_status === 'banned' || user.account_status === 'banned_ip') {
                        localStorage.removeItem('user_credential');
                        localStorage.removeItem('remember_me');
                        Swal.fire({
                            icon: 'error',
                            title: 'TÀI KHOẢN ĐÃ BỊ KHÓA',
                            text: 'Vui lòng liên hệ admin. Tự động đăng nhập đã bị hủy.',
                            background: '#0f0f1a', color:'white',
                            confirmButtonText: 'Đã hiểu'
                        });
                        return;
                    }

                    // *** PHẦN ĐÃ SỬA: Thêm nút hủy bỏ ***
                    Swal.fire({
                        title: 'Đang tự động đăng nhập...',
                        html: 'Sẽ chuyển hướng trong giây lát.<br/><br/>',
                        timer: 2500, // Tăng thời gian lên 2.5s để kịp bấm hủy
                        timerProgressBar: true,
                        showCancelButton: true, // HIỆN NÚT HỦY
                        cancelButtonText: 'HỦY BỎ',
                        cancelButtonColor: '#ef4444',
                        showConfirmButton: false,
                        allowOutsideClick: false,
                        background: '#0f0f1a', color:'white',
                        didOpen: () => Swal.showLoading()
                    }).then((result) => { 
                        // Nếu hết giờ (timer) thì chuyển trang
                        if (result.dismiss === Swal.DismissReason.timer) {
                            window.location.href = 'home.html';
                        } 
                        // Nếu bấm Hủy
                        else if (result.dismiss === Swal.DismissReason.cancel) {
                            // Xóa nhớ đăng nhập tạm thời để người dùng nhập lại nếu muốn
                            // Nếu không muốn xóa thì bỏ dòng dưới đi
                            localStorage.removeItem('remember_me'); 
                            
                            Swal.fire({
                                icon: 'info',
                                title: 'Đã hủy tự động đăng nhập',
                                text: 'Bạn có thể đăng nhập thủ công hoặc tài khoản khác.',
                                timer: 1500,
                                showConfirmButton: false,
                                background: '#0f0f1a', color:'white'
                            });
                        }
                    });
                }
            }
        });

        // --- Functions Giao diện ---
        function toggleLanguage() {
            currentLang = currentLang === 'vi' ? 'en' : 'vi';
            document.getElementById('current-lang-text').textContent = currentLang.toUpperCase();
            const langData = translations[currentLang];
            document.querySelectorAll('[data-lang-key]').forEach(el => el.innerHTML = langData[el.getAttribute('data-lang-key')]);
            document.querySelectorAll('[data-lang-placeholder]').forEach(el => el.setAttribute('placeholder', langData[el.getAttribute('data-lang-placeholder')]));
        }

        function initEventListeners() {
            document.getElementById('tab-signin').addEventListener('click', () => {
                document.getElementById('tab-signin').classList.add('active'); document.getElementById('tab-signup').classList.remove('active');
                document.getElementById('form-signin').classList.add('active'); document.getElementById('form-signup').classList.remove('active');
                document.getElementById('form-subtitle').innerHTML = translations[currentLang]['subtitle_gateway'];
            });
            document.getElementById('tab-signup').addEventListener('click', () => {
                document.getElementById('tab-signup').classList.add('active'); document.getElementById('tab-signin').classList.remove('active');
                document.getElementById('form-signup').classList.add('active'); document.getElementById('form-signin').classList.remove('active');
                document.getElementById('form-subtitle').innerHTML = translations[currentLang]['subtitle_create'];
            });
        }

        function togglePass(id, icon) {
            const input = document.getElementById(id);
            if (input.type === "password") { input.type = "text"; icon.classList.replace('fa-eye', 'fa-eye-slash'); }
            else { input.type = "password"; icon.classList.replace('fa-eye-slash', 'fa-eye'); }
        }

        function checkStrength() {
            const val = document.getElementById('reg_pass').value;
            const bars = document.querySelectorAll('#form-signup .strength-bar');
            bars.forEach(bar => bar.classList.remove('active', 'medium', 'strong'));
            let strength = 0;
            if (val.length > 0) strength = 1; if (val.length >= 6) strength = 2; if (val.length >= 8 && /[0-9]/.test(val)) strength = 3;
            for (let i = 0; i < 5; i++) {
                if (i < strength) bars[i].classList.add('active');
                if (strength === 2) bars[i].classList.add('medium');
                if (strength >= 3) bars[i].classList.add('strong');
            }
        }

        function showSupportModal() { document.getElementById('support-modal').style.display = 'flex'; setTimeout(()=>document.getElementById('support-modal').classList.add('show'),10); }
        function closeSupportModal() { document.getElementById('support-modal').classList.remove('show'); setTimeout(()=>document.getElementById('support-modal').style.display = 'none',300); }

        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 40; i++) {
                const p = document.createElement('div');
                p.style.position = 'absolute'; p.style.width = Math.random()*4+1+'px'; p.style.height = p.style.width;
                p.style.background = 'rgba(99, 102, 241, 0.4)'; p.style.borderRadius = '50%';
                p.style.left = Math.random()*100+'%'; p.style.top = Math.random()*100+'%';
                p.style.animation = `float ${Math.random()*20+10}s ease-in-out infinite`;
                container.appendChild(p);
            }
            const s = document.createElement('style'); s.textContent = `@keyframes float { 0% {transform:translateY(0);} 50% {transform:translateY(-20px);} 100% {transform:translateY(0);} }`; document.head.appendChild(s);
        }

        // ========== LOGIC BACKEND (KẾT NỐI GOOGLE SCRIPT) ==========
        
        // 1. Lấy IP
        async function getUserIP() {
            try { const res = await fetch('https://api.ipify.org?format=json'); const data = await res.json(); return data.ip; } 
            catch { return 'unknown'; }
        }

        // 2. Xử lý Đăng Ký
        async function handleRegister(e) {
            e.preventDefault();
            const btn = document.getElementById('btn-register');
            const user = document.getElementById('reg_email').value.trim();
            const pass = document.getElementById('reg_pass').value.trim();
            const confirm = document.getElementById('confirm_pass').value.trim();
            const fullname = document.getElementById('reg_name').value.trim();

            if(pass !== confirm) return Swal.fire({ icon: 'error', title: 'Lỗi', text: 'Mật khẩu xác nhận không khớp!', background:'#0f0f1a', color:'white' });
            if(/\s/.test(user)) return Swal.fire({ icon: 'warning', title: 'Lỗi', text: 'Tên đăng nhập không được chứa khoảng trắng!', background:'#0f0f1a', color:'white' });

            const oldText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ĐANG XỬ LÝ...'; btn.disabled = true;

            try {
                const ip = await getUserIP();
                const fd = new FormData();
                fd.append('action', 'register'); fd.append('username', user); fd.append('password', pass); fd.append('fullname', fullname); fd.append('ip', ip);

                const res = await fetch(API_URL, { method:'POST', body: fd });
                const data = await res.json();

                if(data.status === 'success') {
                    Swal.fire({ icon:'success', title:'THÀNH CÔNG', text:'Đăng ký thành công! Vui lòng đăng nhập.', background:'#0f0f1a', color:'white' });
                    document.getElementById('tab-signin').click(); // Chuyển sang tab đăng nhập
                    document.getElementById('login_email').value = user;
                } else {
                    Swal.fire({ icon:'error', title:'THẤT BẠI', text: data.message, background:'#0f0f1a', color:'white' });
                }
            } catch(err) {
                Swal.fire({ icon:'error', title:'LỖI MẠNG', text: 'Không kết nối được server!', background:'#0f0f1a', color:'white' });
            } finally {
                btn.innerHTML = oldText; btn.disabled = false;
            }
        }

        // 3. Xử lý Đăng Nhập
        async function handleLogin(e) {
            e.preventDefault();
            const btn = document.getElementById('btn-login');
            const user = document.getElementById('login_email').value.trim();
            const pass = document.getElementById('login_pass').value.trim();
            const remember = document.getElementById('remember_me').checked;

            const oldText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ĐANG KIỂM TRA...'; btn.disabled = true;

            try {
                const ip = await getUserIP();
                const fd = new FormData();
                fd.append('action', 'login'); fd.append('username', user); fd.append('password', pass); fd.append('ip', ip);

                const res = await fetch(API_URL, { method:'POST', body: fd });
                const data = await res.json();

                if(data.status === 'success') {
                    // Lưu local storage
                    const userData = { username: data.username, fullname: data.fullname, balance: data.balance, is_vip: data.is_vip, ip: data.ip, account_status: 'active' }; 
                    localStorage.setItem('user', JSON.stringify(userData));
                    
                    if(remember) {
                        localStorage.setItem('user_credential', JSON.stringify(userData));
                        localStorage.setItem('remember_me', 'true');
                    } else {
                        localStorage.removeItem('user_credential'); localStorage.removeItem('remember_me');
                    }

                    Swal.fire({ icon:'success', title:'THÀNH CÔNG', text: 'Đang vào hệ thống...', timer:1000, showConfirmButton:false, background:'#0f0f1a', color:'white' })
                    .then(() => { window.location.href = 'home.html'; });
                } else {
                    Swal.fire({ icon:'error', title:'ĐĂNG NHẬP LỖI', text: data.message, background:'#0f0f1a', color:'white' });
                }
            } catch(err) {
                Swal.fire({ icon:'error', title:'LỖI MẠNG', text: 'Không kết nối được server!', background:'#0f0f1a', color:'white' });
            } finally {
                btn.innerHTML = oldText; btn.disabled = false;
            }
        }
    </script>
</body>
</html>
